{% extends 'base.html' %}
{% block content %}
<div class="container mt-5 mb-5">
    <div class="mb-4">
        <a href="{% url 'admin-dashboard' %}" class="btn btn-outline-primary rounded-pill">
          <i class="fas fa-arrow-left me-1"></i> Torna alla Dashboard
        </a>
      </div>
    <div class="text-center">
        <h2 class="mb-4 text-success">ðŸ’³ Procedi con il pagamento</h2>
        <p>Importo totale: <strong>{{ totale }} â‚¬</strong></p>
        <div id="paypal-button-container"></div>
    </div>
</div>

<script src="https://www.paypal.com/sdk/js?client-id={{ paypal_client_id }}&currency=EUR"></script>
<script>
    paypal.Buttons({
        createOrder: function(data, actions) {
            return actions.order.create({
                purchase_units: [{
                    amount: {
                        value: '{{ totale }}'
                    }
                }]
            });
        },
        onApprove: function(data, actions) {
            return actions.order.capture().then(function(details) {
                alert('Pagamento completato da ' + details.payer.name.given_name + '!');
                window.location.href = "{% url 'paypal_success' %}";
            });
        },
        onCancel: function (data) {
            alert('Pagamento annullato.');
            window.location.href = "{% url 'checkout' %}";
        }
    }).render('#paypal-button-container');
</script>
{% endblock %}
