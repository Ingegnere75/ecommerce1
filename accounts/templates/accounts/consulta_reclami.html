{% extends 'base.html' %}
{% load static %}

{% block content %}
<style>
    .reclami-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 50px;
    }

    .reclami-table th, .reclami-table td {
        padding: 15px;
        text-align: left;
        vertical-align: top;
        border-bottom: 1px solid #dee2e6;
    }

    .reclami-table th {
        background-color: #343a40;
        color: white;
        font-weight: bold;
    }

    .reclamo-risposta {
        background: #f1f3f5;
        padding: 15px;
        font-size: 15px;
        border-left: 4px solid #198754;
        border-radius: 0 0 8px 8px;
    }

    .no-reclami {
        margin-top: 50px;
    }

    .btn-dashboard {
        margin-top: 30px;
        background: linear-gradient(135deg, #6c757d, #495057);
        color: white;
        font-weight: bold;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        transition: 0.3s;
    }

    .btn-dashboard:hover {
        background: linear-gradient(135deg, #495057, #343a40);
        color: #f8f9fa;
    }

    @media (max-width: 768px) {
        .reclami-table, .reclami-table thead, .reclami-table tbody, .reclami-table th, .reclami-table td, .reclami-table tr {
            display: block;
        }

        .reclami-table thead tr {
            display: none;
        }

        .reclami-table td {
            position: relative;
            padding-left: 50%;
            border: none;
            border-bottom: 1px solid #dee2e6;
        }

        .reclami-table td::before {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 45%;
            padding-right: 10px;
            white-space: nowrap;
            font-weight: bold;
            color: #6c757d;
            content: attr(data-label);
        }

        .reclamo-risposta {
            margin-top: 10px;
        }
    }
</style>

<div class="container mt-5 mb-5">
    <div class="container py-4">
        <!-- Pulsante Torna alla Dashboard -->
        <div class="mb-4">
          <a href="{% url 'dashboard' %}" class="btn btn-outline-primary rounded-pill">
            <i class="fas fa-arrow-left me-1"></i> Torna alla Dashboard
          </a>
        </div>

    <h2 class="text-center text-primary mb-5">I Tuoi Reclami ðŸ“„</h2>

    {% if reclami %}
    <table class="reclami-table">
        <thead>
            <tr>
                <th>Numero Ticket</th>
                <th>Numero Ordine</th>
                <th>Oggetto</th>
                <th>Messaggio</th>
                <th>Stato</th>
                <th>Esito</th>
                <th>Data Invio</th>
                <th>Allegato</th>
            </tr>
        </thead>
        <tbody>
            {% for reclamo in reclami %}
            <tr>
                <td data-label="Numero Ticket">#{{ reclamo.numero_ticket }}</td>
                <td data-label="Numero Ordine">{{ reclamo.numero_ordine }}</td>
                <td data-label="Oggetto">{{ reclamo.oggetto }}</td>
                <td data-label="Messaggio">{{ reclamo.messaggio }}</td>
                <td data-label="Stato">{{ reclamo.get_stato_display }}</td>
                <td data-label="Esito">{{ reclamo.get_esito_display }}</td>
                <td data-label="Data Invio">{{ reclamo.data_invio|date:"d/m/Y H:i" }}</td>
                <td data-label="Allegato">
                    {% if reclamo.allegato %}
                    <a href="{{ reclamo.allegato.url }}" target="_blank" class="btn btn-sm btn-outline-info">Visualizza</a>
                    {% else %}
                    Nessuno
                    {% endif %}
                </td>
            </tr>
            {% if reclamo.risposta_admin %}
            <tr>
                <td colspan="8">
                    <div class="reclamo-risposta">
                        <strong>Risposta Amministratore:</strong> {{ reclamo.risposta_admin }}
                        {% if reclamo.data_risposta %}
                        <div class="text-end mt-2">
                            <small><i>Risposto il {{ reclamo.data_risposta|date:"d/m/Y H:i" }}</i></small>
                        </div>
                        {% endif %}
                    </div>
                </td>
            </tr>
            {% endif %}
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="alert alert-info text-center no-reclami">
        Non hai ancora inviato nessun reclamo.
    </div>
    {% endif %}

    <div class="text-center no-print">
        <a href="{% url 'dashboard' %}" class="btn btn-dashboard">
            ðŸ”™ Torna alla Dashboard
        </a>
    </div>

</div>
{% endblock %}
