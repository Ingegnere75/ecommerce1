
{% extends 'base.html' %}
{% load static %}

{% block title %}Home - Samadafilati{% endblock %}

{% block content %}

<!-- Banner Cookie Modal -->
{% if layout_salvato %}
  {{ layout_salvato|safe }}
{% endif %}

<!-- HERO ZONE -->
{% for el in elementi_hero %}
  {% include 'core/elemento_render.html' with elemento=el %}
{% endfor %}

<!-- HERO BANNERS -->
{% for homebanner in banners_hero %}
  {% include 'core/partials/banner.html' %}
{% endfor %}

<!-- CENTER ZONE -->
{% for el in elementi_center %}
  {% include 'core/elemento_render.html' with elemento=el %}
{% endfor %}

<!-- ELEMENTI DINAMICI -->
{% for elemento in elementi_dinamici %}
  {% if elemento.tipo == "testo" and elemento.contenuto_testo %}
    <section class="my-5 px-3" data-aos="fade-up">
      <div class="container text-center">
        <h4 class="fw-bold mb-3">{{ elemento.titolo }}</h4>
        <p class="text-muted fs-5">{{ elemento.contenuto_testo }}</p>
      </div>
    </section>
  {% elif elemento.tipo == "immagine" and elemento.immagine %}
    <section class="text-center my-5" data-aos="zoom-in">
      <img src="{{ elemento.immagine.url }}"
           style="{% if elemento.larghezza %}width:{{ elemento.larghezza }}px;{% endif %}{% if elemento.altezza %}height:{{ elemento.altezza }}px;{% endif %} object-fit:cover;"
           class="img-fluid rounded shadow mb-3 image-enhanced">
      {% if elemento.titolo %}
        <h5 class="fw-bold">{{ elemento.titolo }}</h5>
      {% endif %}
    </section>
  {% elif elemento.tipo == "video" and elemento.video %}
    <section class="text-center my-5" data-aos="zoom-in-up">
      <video width="{{ elemento.larghezza|default:'70%' }}" height="{{ elemento.altezza }}" controls class="rounded shadow">
        <source src="{{ elemento.video.url }}" type="video/mp4">
        Il tuo browser non supporta il video.
      </video>
      {% if elemento.titolo %}
        <h5 class="fw-bold mt-3">{{ elemento.titolo }}</h5>
      {% endif %}
    </section>
  {% endif %}
{% endfor %}

<!-- CARD SECTION -->
<section class="pt-5 pb-5 bg-white" style="{% if card_sezione.font_family %}font-family: {{ card_sezione.font_family }};{% endif %}">
  <div class="container">
    <div class="section-header text-center mb-5" data-aos="fade-up">
      <h2 class="{{ card_sezione.classe_titolo|default:'fw-bold fs-1' }}">
        {{ card_sezione.titolo }}
      </h2>
      <p class="{{ card_sezione.classe_sottotitolo|default:'text-muted fs-6' }}">
        {{ card_sezione.sottotitolo }}
      </p>
    </div>

    {% if card_sezione.testo_extra %}
    <div class="text-center mb-4">
      <p class="lead">{{ card_sezione.testo_extra|safe }}</p>
    </div>
    {% endif %}

    <div class="row justify-content-center">
      {% for card in cards %}
      <div class="col-md-4 text-center mb-5 {% if forloop.counter0|divisibleby:2 %}animated-left{% else %}animated-right{% endif %}">
        <a href="{{ card.get_link }}" class="text-decoration-none d-block">
          <div class="card-img-container">
            <img src="{{ card.immagine.url }}"
                 alt="{{ card.titolo }}"
                 style="width:{{ card.larghezza|default:300 }}px; height:{{ card.altezza|default:250 }}px; object-fit:cover;"
                 class="img-fluid mb-3 rounded shadow card-img-hover image-enhanced">
          </div>
          <h5 class="fw-bold text-dark">{{ card.titolo }}</h5>
          {% if card.descrizione %}
          <p class="text-muted small">{{ card.descrizione }}</p>
          {% endif %}
        </a>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- âœ… BANNER INFORMATIVO SPOSTATO DOPO LE CARD -->
{% if banner %}
  <section class="py-5 mt-5"
    {% if banner.immagine_sfondo and banner.immagine_sfondo.url %}
      style="
        background-image: url('{{ banner.immagine_sfondo.url }}');
        background-size: cover;
        background-position: center;
        width: 100%;
        height: {{ banner.altezza }}px;"
    {% else %}
      style="background-color: #333; width: 100%; height: {{ banner.altezza }}px;"
    {% endif %}
  >
    <div class="container text-center text-white d-flex flex-column justify-content-center align-items-center h-100"
         style="max-width: {{ banner.larghezza }}px;">
      <h2 class="fw-bold"
          style="font-family: {{ banner.font_titolo|default:'sans-serif' }};
                 color: {{ banner.font_color|default:'#ffffff' }};">
        {{ banner.titolo }}
      </h2>
      <p class="mb-4"
         style="color: {{ banner.font_color|default:'#ffffff' }};">
        {{ banner.sottotitolo }}
      </p>
      <a href="{% url 'blog-home' %}" class="btn btn-lg"
         style="background-color: {{ banner.colore_bottone|default:'#007bff' }}; color: #fff;">
        {{ banner.testo_bottone }}
      </a>
    </div>
  </section>
{% endif %}




<!-- CENTER BANNERS -->
{% for homebanner in banners_center %}
  {% include 'core/partials/banner.html' %}
{% endfor %}

<!-- BOTTOM ZONE -->
{% for el in elementi_bottom %}
  {% include 'core/elemento_render.html' with elemento=el %}
{% endfor %}

<!-- BOTTOM BANNERS -->
{% for homebanner in banners_bottom %}
  {% include 'core/partials/banner.html' %}
{% endfor %}

<!-- CUSTOM ZONE -->
{% for el in elementi_custom %}
  {% include 'core/elemento_render.html' with elemento=el %}
{% endfor %}

<!-- COOKIE SCRIPT -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    if (!localStorage.getItem("cookieConsent")) {
      const cookieModal = new bootstrap.Modal(document.getElementById('cookieConsentModal'));
      cookieModal.show();

      document.getElementById('acceptCookies').addEventListener('click', () => {
        localStorage.setItem("cookieConsent", JSON.stringify({ analytics: true, marketing: true }));
        cookieModal.hide();
      });

      document.getElementById('declineCookies').addEventListener('click', () => {
        localStorage.setItem("cookieConsent", JSON.stringify({ analytics: false, marketing: false }));
        cookieModal.hide();
      });

      document.getElementById('customizeCookies').addEventListener('click', () => {
        const analytics = document.getElementById('cookieAnalytics').checked;
        const marketing = document.getElementById('cookieMarketing').checked;
        localStorage.setItem("cookieConsent", JSON.stringify({ analytics, marketing }));
        cookieModal.hide();
      });
    }
  });
</script>

<style>
.image-enhanced {
  filter: brightness(1.05) contrast(1.1) saturate(1.2);
}

.card-img-container {
  overflow: hidden;
  border-radius: 10px;
}

.card-img-hover {
  transition: transform 0.5s ease;
}

.card-img-hover:hover {
  transform: scale(1.15) rotate(1.5deg);
}

.animated-right {
  animation: slide-from-right 1.5s ease forwards;
  opacity: 0;
}

.animated-left {
  animation: slide-from-left 1.5s ease forwards;
  opacity: 0;
}

@keyframes slide-from-right {
  0% {
    transform: translateX(100px);
    opacity: 0;
  }
  100% {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes slide-from-left {
  0% {
    transform: translateX(-100px);
    opacity: 0;
  }
  100% {
    transform: translateX(0);
    opacity: 1;
  }
}
</style>

{% endblock %}
